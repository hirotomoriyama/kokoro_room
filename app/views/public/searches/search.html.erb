<!--ページタイトルの指定-->
<% content_for :title do %>
  <% if @content.present? %>
    「<%= @content %>」の検索結果一覧 | kokoro room
  <% else %>
    検索ワードが入力されていません | kokoro room
  <% end %>
<% end %>

<div class="container">

  <div class="row my-5">
    <div class="col-6">
      <!--検索結果により見出しを変更-->
      <% if @content.present? %>
        <h2 class="mark text-center rounded">「<%= @content %>」の検索結果一覧</h2>
      <% else %>
        <h2 class="text-center">検索ワードが入力されていません</h2>
      <% end %>
    </div>
  </div>

<!--検索結果がある場合-->
<% if @datas.present? %>

  <div class="row d-flex flex-wrap pb-5">

    <% @datas.reverse_each do |data| %>

    <div class="col-4 bg-light border border-secondary m-5 p-5 rounded">
      <!--ベストアンサーが決定済みであれば解決済みを表示、未決定であれば回答受付中を表示-->
      <% if data.best_answer_id.present? %>
        <h5 class="text-success"><i class="fas fa-check-circle"></i> 解決済み</h5>
      <% else %>
        <h5 class="text-danger"><i class="fas fa-bullhorn"></i> 回答受付中</h5>
      <% end %>

      <!--ユーザーが退会していればニックネームを非表示-->
      <h4>
        <% if data.member.is_deleted == false %>
          <%= attachment_image_tag data.member, :image, size:"40x40", format:'jpeg', fallback:"no_image.jpg", class:"rounded-circle" %> <%= data.member.name %>さんの投稿
        <% else %>
          <!--ユーザーが退会していれば、プロフィール画像はデフォルト表示-->
          <%= image_tag "no_image.jpg", size:"40x40", format:'jpeg', class:"rounded-circle" %> 退会済みユーザーさんの投稿
        <% end %>
      </h4>

      <h5 class="mt-3">投稿日時</h5>
      <%= data.created_at.to_s(:datetime_jp) %>

      <h4 class="mt-3">タイトル</h4>
      <!--タイトルをクリック後、悩み事詳細画面へ遷移-->
      <%= link_to data.title, problem_path(data.id) %>

      <h4 class="mt-3">悩み事の内容</h4>
      <%= data.body %>

      <h4 class="mt-3">カテゴリー</h4>
      <%= data.category.name %>
    </div>

  <% end %>

  <%= render 'layouts/back' %>

  </div>

<!--検索結果が無い場合-->
<% else %>

  <div class="row pl-5">
    <% if @content.present? %>
      <h4 class="ml-5 pl-5">検索結果はありませんでした。</h4>
    <% else %>
      <h4 class="ml-5 pl-5">検索ワードを入力後、再度検索してください。</h4>
    <% end %>
  </div>

<% end %>

</div>