<!--ページタイトルの指定-->
<% content_for :title do %>
  悩み事一覧 | kokoro room
<% end %>

<div class="container py-5">

  <!--サクセスメッセージの表示-->
  <%= render 'layouts/notice' %>

  <div class="row my-5">
    <div class="col-6">
      <h2 class="mark text-center rounded">悩み事一覧</h2>
    </div>
    <div class="form-inline">
      <!--悩み事の絞り込み検索-->
      <%= form_tag(admin_path, method: :get) do %>
        <%= select_tag 'option', options_for_select({"全て表示" => "all", "回答受付中" => "unsolved", "解決済み" => "solved", "回答受付終了" => "finished"}), class:"form-control form-control-lg badge badge-light" %>
        <%= button_tag :type => "submit", :class => "form-control form-control-lg badge badge-light" do %>
          <i class="fa fa-search"></i> 絞り込み検索
        <% end %>
      <% end %>
    </div>
  </div>

  <div class="row d-flex flex-wrap">
    <% @problems.reverse_each do |problem| %>

    <div class="col-4 bg-light border border-secondary m-5 p-5 rounded">
      <!--ベストアンサーが決定済みの場合-->
      <% if problem.best_answer_id.present? %>
        <h5 class="text-success"><i class="fas fa-check-circle"></i> 解決済み</h5>
      <!--ベストアンサーが未決定、悩み事の投稿者が退会状態の場合-->
      <% elsif problem.member.is_deleted != false %>
        <h5 class="text-secondary"><i class="far fa-hand-paper"></i> 回答受付終了</h5>
      <!--上記以外の場合-->
      <% else %>
        <h5 class="text-danger"><i class="fas fa-bullhorn"></i> 回答受付中</h5>
      <% end %>

      <h4>会員名</h4>
      <!--会員名をクリックすると会員詳細画面に遷移-->
      <%= attachment_image_tag problem.member, :image, size:"40x40", format:'jpeg', fallback:"no_image.jpg", class:"rounded-circle" %> <%= link_to problem.member.name, admin_member_path(problem.member_id) %>さん

      <h5 class="mt-3">投稿日時</h5>
      <%= problem.created_at.to_s(:datetime_jp) %>

      <h4 class="mt-3">タイトル</h4>
      <%= problem.title %>

      <h4 class="mt-3">悩み事の内容</h4>
      <%= problem.body %>

      <h4 class="mt-3">カテゴリー</h4>
      <%= problem.category.name %>
    </div>

    <% end %>
  </div>

<%= render 'layouts/back' %>

</div>